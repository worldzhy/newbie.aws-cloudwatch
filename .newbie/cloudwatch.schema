// !! ------------------------------------------------------------ //
// !!            [Microservice] AWS CloudWatch models              //
// !! ------------------------------------------------------------ //
// * AwsAccount                                                    //
// * Ec2Instance                                                   //
// * RdsInstance                                                   //
// * ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ ⌄ //

model AwsAccount {
  id              String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  awsAccountId    String        @unique
  iamUserName     String
  accessKeyId     String        @unique
  secretAccessKey String
  regions         AwsRegion[]
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  ec2Instances    Ec2Instance[]
  rdsInstances    RdsInstance[]

  @@schema("microservice/cloudwatch")
}

model Ec2Instance {
  id           String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  instanceId   String     @unique
  name         String
  status       String
  region       AwsRegion
  isWatching   Boolean    @default(false)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  awsAccount   AwsAccount @relation(fields: [awsAccountId], references: [id])
  awsAccountId String

  @@schema("microservice/cloudwatch")
}

model RdsInstance {
  id           String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  instanceId   String
  name         String
  status       String
  region       AwsRegion
  isWatching   Boolean    @default(false)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
  awsAccount   AwsAccount @relation(fields: [awsAccountId], references: [id])
  awsAccountId String

  @@unique([instanceId, region, awsAccountId])
  @@schema("microservice/cloudwatch")
}

enum AwsRegion {
  us_east_1
  us_east_2

  @@schema("microservice/cloudwatch")
}
